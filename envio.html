// Importar los módulos de Firebase
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";

// Configuración de tu proyecto (la sacas de Firebase Console)
const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "lumers-web.firebaseapp.com",
  projectId: "lumers-web-81346186",
  storageBucket: "lumers-web-81346186.appspot.com",
  // ... resto de tu config
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Función para guardar el envío
async function guardarEnvio(datos) {
  try {
    const docRef = await addDoc(collection(db, "envios"), datos);
    console.log("Envío registrado con ID: ", docRef.id);
  } catch (e) {
    console.error("Error al añadir: ", e);
  }
}
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-storage.js";

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

async function crearEnvioConFoto() {
    const file = document.getElementById('fotoPaquete').files[0];
    const descripcion = document.getElementById('descripcion').value;
    
    // 1. Subir la foto al Bucket de Google Cloud/Firebase
    const storageRef = ref(storage, 'paquetes/' + Date.now() + "_" + file.name);
    const snapshot = await uploadBytes(storageRef, file);
    const urlFoto = await getDownloadURL(snapshot.ref);

    // 2. Guardar el registro en Firestore con la URL de la foto
    await addDoc(collection(db, "envios"), {
        descripcion: descripcion,
        fotoUrl: urlFoto,
        estado: "abierto", // Para que aparezca en la subasta
        fechaCreacion: new Date(),
        valorDeclarado: document.getElementById('valor').value
    });
    
    alert("Envío publicado con éxito");
}
